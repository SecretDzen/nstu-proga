barplot(table(data[, table_row]),
main = main,
border = "red",
col = "blue",
density = 10
)
}
barplot_builder(group_one, "satisfactionDegree", "Степень удовлетворенности услугами", 1)
barplot_builder(group_one, "satisfactionDegree", "Степень удовлетворенности услугами", 1)
barplot_builder(group_one, "satisfactionDegree", "Степень удовлетворенности услугами", 2)
barplot_builder <- function(table_row, main) {
barplot(table(table_row),
main = main,
border = "red",
col = "blue",
density = 10
)
}
barplot_builder(subset(group_one, sex == 1)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 2)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 1)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 2)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 1)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 2)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 1)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 2)$satisfactionDegree, "Степень удовлетворенности услугами")
par(mfrow = c(1, 2))
barplot_builder(subset(group_one, sex == 1)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 2)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 1)$satisfactionRate, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 1)$satisfactionRate, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 1)$satisfactionRate, "Степень удовлетворенности услугами")
barplot_builder(subset(group_one, sex == 2)$satisfactionRate, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 1)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 2)$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 1)$satisfactionRate, "Степень удовлетворенности услугами")
barplot_builder(subset(group_two, sex == 2)$satisfactionRate, "Степень удовлетворенности услугами")
par(mfrow = c(1, 1))
boxplot_builder(group_one$sex, group_one$satisfactionRate, "s", "a", group_one)
boxplot_builder <- function(table_row_k, table_row_n, main, xlab, ylab, data) {
boxplot(table_row_n ~ table_row_k,
main = main,
xlab = xlab,
ylab = ylab,
col = "#AACCFF",
data = data
)
}
boxplot_builder(group_one$sex, group_one$satisfactionRate, "Ящик с усами", "Пол", "Удовлетворенность услугами",  group_one)
boxplot_builder(group_two$sex, group_two$satisfactionRate, "Ящик с усами", "Пол", "Удовлетворенность услугами", group_two)
lines(density(data$satisfactionRate))
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", ylab="y", main="main")
lines(density(data$satisfactionRate))
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", ylab="y", main="main")
lines(density(data$purchasesYearly))
hist(data$satisfactionRate, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", main="")
lines(density(data$satisfactionRate))
hist(data$averagePurchasesPrice, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", main="")
lines(density(data$averagePurchasesPrice))
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", main="")
lines(density(data$purchasesYearly))
hist(data$purchasesYearly,
freq=FALSE,
breaks=20,
col = "#AACCFF",
xlab="Диапазон годовой покупки",
main="Гистограмма распределения"
)
lines(density(data$purchasesYearly))
pairs(~data$age + data$purchasesYearly + data$averagePurchasesPrice
+ data$averagePagesPerVisit + data$averagePagesPerVisit
+ data$satisfactionRate,
lower.panel = NULL
)
chisq_builder(group_one)
chisq_builder(group_two)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2 || col_name2 == 'group') next
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
chisq_builder(group_one)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(fisher_results)
}
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
chisq_builder(group_one)
chisq_builder(group_two)
chisq_builder(group_one)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == col_name2) next
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == col_name2) next
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(fisher_results)
}
chisq_builder(group_one)
chisq_builder(group_two)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(fisher_results)
}
chisq_builder(group_one)
chisq_builder(group_one)
chisq_builder(group_two)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(fisher_results)
}
fisher_builder(group_one)
fisher_builder(group_two)
chisq_builder(group_two)
fisher_builder(group_two)
data <- read.table('./dataset.csv',
header = TRUE,
sep = ',',
stringsAsFactors = FALSE
)
group_one <- subset(data, group == 1)
group_two <- subset(data, group == 2)
fisher_builder(group_two)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(fisher_results)
}
fisher_builder(group_two)
fisher_builder(group_one)
data <- read.table('./dataset.csv',
header = TRUE,
sep = ',',
stringsAsFactors = FALSE
)
View(data)
data$group <- as.factor(data$group)
data$sex <- as.factor(data$sex)
data$participationInSurveys <- as.factor(data$participationInSurveys)
data$satisfactionDegree <- as.factor(data$satisfactionDegree)
group_one <- subset(data, group == 1)
group_two <- subset(data, group == 2)
fisher_builder(group_one)
fisher_builder(group_two)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]), B = 1e7)$p.value
}
}
View(fisher_results)
}
fisher_builder(group_one)
fisher_builder(group_two)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]),simulate.p.value=TRUE, B = 1e7)$p.value
}
}
View(fisher_results)
}
fisher_builder(group_one)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
factor_names <- subset(factor_names, factor_names != 'group')
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]), workspace = 2e8)$p.value
}
}
View(fisher_results)
}
fisher_builder(group_one)
fisher_builder(group_two)
aov_model <- aov(group_one$purchasesYearly ~ group_one$sex, group_one = group_one)
summary(aov_model)
cor_builder(group_one)
summary(aov_model)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
summary(N1)
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
describe(N1)
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
View(N1)
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, M != 'id')
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
View(N1)
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -'id')
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
View(N1)
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
View(N1)
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
fisher_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
N1 <- cor(M,use="pairwise.complete.obs", method="pearson")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
N1 <- cor(M,use="pairwise.complete.obs", method="pearson")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
print("Pearson")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
cor_builder(group_two)
pcor_builder(group_one, c(3, 4, 5))
pcor_builder <- function(data, depend) {
M <- data[,unlist(lapply(data, is.numeric))]
View(M)
pcor(depend, cov(M))
}
pcor_builder(group_one, c(3, 4, 5))
pcor_builder <- function(data, depend) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
View(M)
pcor(depend, cov(M))
}
pcor_builder(group_one, c(3, 4, 5))
pcor_builder(group_one, c(4, 6))
pcor_builder <- function(data, depend) {
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
pcor(depend, cov(M))
}
pcor_builder(group_one, c(4, 6, 1))
pcor_builder(group_one, c(4, 6, 1, 2, 3, 5))
pcor_builder(group_two, c(4, 6, 1, 2, 3, 5))
corrplot_builder(group_one, c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
corrplot_builder <- function(data, method) {
colors <- c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA")
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M, use="pairwise.complete.obs", method = method)
col <- colorRampPalette(colors)
corrplot(N1, method="color", col=NULL,
type="upper", order="hclust",
addCoef.col = "black", tl.col="black", tl.srt=45,
sig.level = 0.01, insig = "blank",
diag=FALSE
)
}
corrplot_builder(group_one, "pearson")
corrplot_builder(group_one, "kendall")
corrplot_builder <- function(data, method) {
colors <- c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA")
M <- data[,unlist(lapply(data, is.numeric))]
M <- subset(M, select = -id)
N1 <- cor(M, use="pairwise.complete.obs", method = method)
col <- colorRampPalette(colors)
corrplot(N1, method="color", col=NULL,
type="upper", order="hclust",
addCoef.col = "black", tl.col="black", tl.srt=45,
sig.level = 0.01, insig = "blank",
diag=FALSE
)
}
cor.test(group_one$purchasesYearly, group_one$age)
corrplot_builder(group_one, "kendall")
corrplot_builder(group_one, "pearson")
corrplot_builder(group_one, "pearson")
corrplot_builder(group_one, "kendall")
corrplot_builder(group_one, "spearman")
corrplot_builder(group_two, "pearson")
corrplot_builder(group_two, "kendall")
corrplot_builder(group_two, "spearman")
cor.test(group_one$satisfactionRate, group_one$averagePagesPerVisit)
cor.test(group_two$satisfactionRate, group_two$averagePagesPerVisit)
corrplot_builder(group_one, "pearson")
corrplot_builder(group_two, "pearson")
