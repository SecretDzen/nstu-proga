boxplot_builder(group_two$sex, group_two$satisfactionRate, "s", "a", group_two)
hist(data$satisfactionRate, freq=FALSE, breaks=12, col=”red”, xlab=”название оси X”, main=”Гистограмма”)
lines(density(data$satisfactionRate))
hist(data$satisfactionRate, freq=FALSE, breaks=12, col = ”red”, xlab=”название оси X”, main=”Гистограмма”)
hist(data$satisfactionRate, freq=FALSE, breaks=12, col = "red", xlab="x", main="main")
lines(density(data$satisfactionRate))
hist(data$satisfactionRate, freq=FALSE, breaks=12, col = "red", xlab="x", main="main")
hist(data$age, freq=FALSE, breaks=12, col = "red", xlab="x", main="main")
hist(data$satisfactionRate, freq=FALSE, breaks=12, col = "red", xlab="x", main="main")
lines(density(data$satisfactionRate))
pairs(~data$age+data$purchasesYearly+data$averagePurchasesPrice+data$averagePagesPerVisit+data$averagePagesPerVisit, lower.panel=NULL)
pairs(~data$age + data$purchasesYearly + data$averagePurchasesPrice
+ data$averagePagesPerVisit + data$averagePagesPerVisit
+ data$satisfactionRate,
lower.panel=NULL
)
chisq.test(table(group_one$age, group_two$age))
chisq.test(table(group_one$age, group_one$sex))
chisq.test(table(group_one$participationInSurveys, group_one$sex))
chisq.test(table(group_one$sex, group_one$satisfactionDegree))
chisq.test(table(group_one$participationInSurveys, group_one$satisfactionDegree))
chisq.test(table(group_two$participationInSurveys, group_two$sex))
fisher.test(table(group_one$participationInSurveys, group_one$sex))
fisher.test(table(group_one$sex, group_one$satisfactionDegree))
fisher.test(table(group_one$participationInSurveys, group_one$satisfactionDegree))
fisher.test(table(group_two$participationInSurveys, group_two$satisfactionDegree))
fisher.test(table(group_one$participationInSurveys, group_one$satisfactionDegree))
chisq_builder <- function(data, ) {
chisq_builder <- function(data ) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
View (factor_names)
}
chisq_builder(group_one)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
View (factor_names)
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names){
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
chisq_builder(group_one)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
View (factor_names)
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2) continie
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
chisq_builder(group_one)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2) next
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
chisq_builder(group_one)
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2) next
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
if (col_name == 'group' || col_name == col_name2 || col_name2 == 'group') next
chisq_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
chi_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(chi_results) <- c(factor_names)
rownames(chi_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2 || col_name2 == 'group') next
chi_results[col_name,col_name2] <- chisq.test(table(data[,col_name],data[,col_name2]))$p.value
}
}
View(chi_results)
}
chisq_builder(group_one)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2 || col_name2 == 'group') next
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(chi_results)
}
fisher_builder(group_one)
fisher_builder <- function(data) {
factor_names <- names(data[,unlist(lapply(data, is.factor))])
fisher_results <- matrix(NA,
nrow = length(factor_names),
ncol = length(factor_names)
)
colnames(fisher_results) <- c(factor_names)
rownames(fisher_results) <- c(factor_names)
for (col_name in factor_names){
for (col_name2 in factor_names) {
if (col_name == 'group' || col_name == col_name2 || col_name2 == 'group') next
fisher_results[col_name, col_name2] <- fisher.test(table(data[,col_name], data[,col_name2]))$p.value
}
}
View(fisher_results)
}
fisher_builder(group_one)
aov_builder <- function(data, qualitative) {
numeric_names <- names(data[,unlist(lapply(data, is.numeric))])
for (col_name in numeric_names) {
aov_model <- aov(data$col_name ~ data$qualitative, data = data)
summary(aov_model)
}
}
aov_builder(group_one, sex)
aov_builder <- function(data, qualitative) {
numeric_names <- names(data[,unlist(lapply(data, is.numeric))])
View(numeric_names)
for (col_name in numeric_names) {
aov_model <- aov(data$col_name ~ data$qualitative, data = data)
summary(aov_model)
}
}
aov_builder(group_one, sex)
aov_builder <- function(data, qualitative) {
numeric_names <- names(data[,unlist(lapply(data, is.numeric))])
View(numeric_names)
for (col_name in numeric_names) {
aov_model <- aov(table(data[, col_name]) ~ data$qualitative, data = data)
summary(aov_model)
}
}
aov_builder(group_one, sex)
aov_builder <- function(data, qualitative) {
numeric_names <- names(data[,unlist(lapply(data, is.numeric))])
View(numeric_names)
for (col_name in numeric_names) {
aov_model <- aov(table(data[, col_name]) ~ table(data[, qualitative]), data = data)
summary(aov_model)
}
}
aov_builder(group_one, sex)
aov_builder(group_one, sex)
aov_builder <- function(data, qualitative) {
numeric_names <- names(data[,unlist(lapply(data, is.numeric))])
for (col_name in numeric_names) {
aov_model <- aov(table(data[, col_name]) ~ table(data[, qualitative]), data = data)
summary(aov_model)
}
}
aov_builder(group_one, sex)
aov_builder(group_one, group)
aov_model <- aov(table(data[, col_name]) ~ qualitative, data = data)
aov_builder(group_one, group_one$sex)
aov_builder <- function(data, qualitative) {
numeric_names <- names(data[,unlist(lapply(data, is.numeric))])
for (col_name in numeric_names) {
aov_model <- aov(table(data[, col_name]) ~ qualitative, data = data)
summary(aov_model)
}
}
aov_builder(group_one, group_one$sex)
aov_model <- aov(group_one$purchasesYearly ~ group_one$sex, group_one=group_one)
summary(aov_model)
summary(table(group_one[, purchasesYearly]))
summary(table(group_one[purchasesYearly]))
summary(table(group_one[purchasesYearly]))
summary(table(group_one['purchasesYearly']))
aov_builder(group_one, group_one$sex)
aov_model <- aov(table(data[, group_one$purchasesYearly]) ~ group_one$sex, data = data)
aov_model <- aov(table(data[, purchasesYearly]) ~ group_one$sex, data = data)
aov_model <- aov(table(data[, 'purchasesYearly']) ~ group_one$sex, data = data)
aov_model <- aov(table(data[, 'purchasesYearly']) ~ group_one$sex, data = data)
aov_model <- aov(group_one$purchasesYearly ~ group_one$sex, group_one = group_one)
summary(aov_model)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
print(N1)
print(N2)
print(N3)
}
cor_builder(group_one)
cor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M,use="pairwise.complete.obs")
N2 <- cor(M,use="pairwise.complete.obs",method="spearman")
N3 <- cor(M,use="pairwise.complete.obs",method="kendall")
print("General")
print(N1)
print("Spearman")
print(N2)
print("Kendall")
print(N3)
}
cor_builder(group_one)
pcor_builder <- function(data) {
M <- data[,unlist(lapply(data, is.numeric))]
pcor(c(2,5,1,3,4), cov(M))
}
pcor_builder(group_one)
library(ggm)
pcor_builder(group_one)
pcor_builder <- function(data, depend) {
M <- data[,unlist(lapply(data, is.numeric))]
pcor(depend, cov(M))
}
pcor_builder(group_one, c(3, 4, 5))
library("corrplot")
install.packages("corrplot")
install.packages("corrplot")
library(corrplot)
col <- colorRampPalette(colors)
corrplot_builder <- function(data, colors) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M,use="pairwise.complete.obs")
col <- colorRampPalette(colors)
corrplot(N1, method="color", col=col,
type="upper", order="hclust",
addCoef.col = "black", tl.col="black", tl.srt=45,
sig.level = 0.01, insig = "blank",
diag=FALSE
)
}
corrplot_builder(group_one, c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
corrplot_builder <- function(data, colors) {
M <- data[,unlist(lapply(data, is.numeric))]
N1 <- cor(M, use="pairwise.complete.obs")
col <- colorRampPalette(colors)
corrplot(N1, method="color", col=NULL,
type="upper", order="hclust",
addCoef.col = "black", tl.col="black", tl.srt=45,
sig.level = 0.01, insig = "blank",
diag=FALSE
)
}
corrplot_builder(group_one, c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
cor.test(group_one$purchasesYearly, group_one$age)
chisq_builder(group_one)
describe_builder <- function(data) {
sm <- describe(data)
View(data)
}
describe_builder(data)
library(psych)
library(corrplot)
describe_builder(data)
View(data)
str(data)
summary(data)
View(data)
describe_builder(data)
describe_builder(group_one)
plot_builder(group_one$age, group_one$averagePurchasesPrice, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_two$age, group_two$averagePurchasesPrice, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$age, group_one$averagePurchasesPrice, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_two$age, group_two$averagePurchasesPrice, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$age, group_one$purchasesYearly, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$age, group_one$age, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$age, group_one$supportRequestYearly, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$age, group_one$participationInSurveys, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$age, group_one$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$averagePurchasesPrice, group_one$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$supportRequestYearly, group_one$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$sex, group_one$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate, "Диаграмма рассеяния", "Возраст", "Средняя стоимость покупки")
plot_builder(group_one$averagePagesPerVisit, group_one$averagePurchasesPrice,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Средняя стоимость покупок"
)
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Средняя стоимость покупки"
)
pie_builder(group_one$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
pie_builder(group_two$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
barplot_builder(group_one$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(group_two$satisfactionDegree, "Степень удовлетворенности услугами")
boxplot_builder(group_one$sex, group_one$satisfactionRate, "s", "a", group_one)
boxplot_builder(group_two$sex, group_two$satisfactionRate, "s", "a", group_two)
boxplot_builder(group_one$sex, group_one$satisfactionRate, "s", "a", group_one)
hist(data$satisfactionRate, freq=FALSE, breaks=12, col = "red", xlab="x", main="main")
lines(density(data$satisfactionRate))
hist(data$purchasesYearly, freq=FALSE, breaks=12, col = "red", xlab="x", main="main")
lines(density(data$satisfactionRate))
hist(data$purchasesYearly, freq=FALSE, breaks=9, col = "red", xlab="x", main="main")
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "red", xlab="x", main="main")
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "red", xlab="x", ylab="y", main="main")
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", ylab="y", main="main")
pairs(~data$age + data$purchasesYearly + data$averagePurchasesPrice
+ data$averagePagesPerVisit + data$averagePagesPerVisit
+ data$satisfactionRate,
lower.panel=NULL
)
describe_builder(data)
describe_builder(group_one)
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Средняя стоимость покупки"
)
plot_builder(group_two$averagePagesPerVisit, group_two$averagePurchasesPrice,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Средняя стоимость покупки"
)
plot_builder(group_one$averagePagesPerVisit, group_one$averagePurchasesPrice,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_one$averagePurchasesPrice, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_one$supportRequestYearly, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_two$supportRequestYearly, group_two$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Средняя стоимость покупки"
)
plot_builder(group_one$supportRequestYearly, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Степень удовлетворенности услугами"
)
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Средняя стоимость покупки"
)
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Удовлетворенность услугами"
)
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Удовлетворенность услугами"
)
pie_builder(group_two$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
plot_builder(group_one$averagePagesPerVisit, group_one$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Удовлетворенность услугами"
)
pie_builder(group_one$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
pie_builder(group_two$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
plot_builder(group_two$averagePagesPerVisit, group_two$satisfactionRate,
"Диаграмма рассеяния", "Средняя посещаемость страниц",
"Удовлетворенность услугами"
)
pie_builder(group_one$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
pie_builder(group_two$satisfactionDegree,
"Распределение по удовлетворенности услугами",
c("#AAFFCC", "#FFAACC", "#AACCFF"),
c("average", "high", "low")
)
barplot_builder(group_one$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(group_two$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(group_one$satisfactionDegree, "Степень удовлетворенности услугами")
barplot_builder(group_two$satisfactionDegree, "Степень удовлетворенности услугами")
boxplot_builder(group_one$sex, group_one$satisfactionRate, "s", "a", group_one)
boxplot_builder(group_two$sex, group_two$satisfactionRate, "s", "a", group_two)
boxplot_builder(group_one$sex, group_one$satisfactionRate, "s", "a", group_one)
boxplot_builder(group_two$sex, group_two$satisfactionRate, "s", "a", group_two)
hist(data$purchasesYearly, freq=FALSE, breaks=20, col = "#AACCFF", xlab="x", ylab="y", main="main")
lines(density(data$satisfactionRate))
pairs(~data$age + data$purchasesYearly + data$averagePurchasesPrice
+ data$averagePagesPerVisit + data$averagePagesPerVisit
+ data$satisfactionRate,
lower.panel=NULL
)
chisq_builder(group_one)
chisq_builder(group_two)
describe_builder <- function(data) {
sm <- describe(data)
View(sm)
}
describe_builder(data)
View(data)
str(data)
summary(data)
summary(group_one)
summary(group_two)
base_stats <- function(x) {
if(is.numeric(x)) {
s<-sd(x)
m<-mean(x)
n<-length(x)
skew<-sum((x-m)^3/s^3)/n
kurt<-sum((x-m)^4/s^4)/n-3
uniqv<-unique(x)
return(c(sd=s,skew=skew,kurtosis=kurt,mode=uniqv[which.max(tabulate(match(x,uniqv)))]))
}
}
base_stats(data)
base_stats <- function(x) {
if(is.numeric(x)) {
s<-sd(x)
m<-mean(x)
n<-length(x)
skew<-sum((x-m)^3/s^3)/n
kurt<-sum((x-m)^4/s^4)/n-3
uniqv<-unique(x)
View(c(sd=s,skew=skew,kurtosis=kurt,mode=uniqv[which.max(tabulate(match(x,uniqv)))]))
}
}
base_stats(data)
base_stats(data$age)
summary(data)
base_stats(data$purchasesYearly)
base_stats(data$averagePurchasesPrice)
base_stats(data$averagePagesPerVisit)
base_stats(data$supportRequestYearly)
base_stats(data$satisfactionRate)
summary(group_one)
summary(group_two)
base_stats(group_one$age)
base_stats(group_one$purchasesYearly)
base_stats(group_one$averagePurchasesPrice)
base_stats(group_one$averagePagesPerVisit)
base_stats(group_one$supportRequestYearly)
base_stats(group_one$satisfactionRate)
base_stats(group_two$age)
base_stats(group_two$purchasesYearly)
base_stats(group_two$averagePurchasesPrice)
base_stats(group_two$averagePagesPerVisit)
base_stats(group_two$supportRequestYearly)
base_stats(group_two$satisfactionRate)
